<details>
  <summary>Сентябрь 2025</summary>

<details>
  <summary>Яндекс</summary>

пт
# [1] Задача 
 ```sql
with tmp as (select user_id, order_id,
row_number() over (partition by user_id order by order_timestamp) as rn
from taxi)
select user_id, order_id from tmp
where rn = 1

 ```
 # [2] Задача 
 ```sql
select t1.car_number
from sandbox.zvereva_taxi_orders t1 join sandbox.zvereva_taxi_orders t2 on t1.car_number = t2.car_number
and t1.endd>t2.start and t1.start<t2.endd

 ```
 # [3] Задача 
 ```python
'''1 вариант:'''

from collections import Counter

def find_mode (arr: list):
  arr = Counter(arr)
  return max (counter, key = counter.get)

'''2 вариант'''

def find_mode (arr: list):
  moda_count = 0
  k = 0
  arr = sorted(arr)
  for i in range (len(arr)-1):
    if arr[i] == arr[i+1]:
      k += 1
    else:
      if k > moda_count:
        moda_count = k
        moda = arr[i]
      k = 0
  return moda


 ```
 # [4] Задача 
 ```python

def func(d:dict):
  d_new = {}
  arr_keys = list(d.keys())
  arr_values = list(d.values())
  for i in range(len(d)):
    d_new.update ({ arr_values[i] : arr_keys[i]})

  return d_new

 ```

</details>

<details>
  <summary>ЭР-Телеком</summary>

сб
 # [1] Задача 
[1, 2, 3, 1, 2, 3]

 # [2] Задача 
arr = [x*2 for x in arr]

 # [3] Задача 

 1 
 2
 3 


 1

# [4] Задача 

Каждому человеку даем 2 стаканчика, он их пробует всплепую, очередность стаканчиков определяется рандомом. Затем собираем выборку из большого числа наблюдений. Считаем кол-во голосов за каждый вид колы, а затем с помощью стат теста проверяем, значимы ли статистически результаты. Стат тест берем биномиальный, потому что он подходит для бинарных выводов

(задача на двойное слепое тестирование)


</details>



<details>
  <summary>Т-банк</summary>

вс
# [1] Задача 

 ```sql
select t1.id, t1.department_id
from employee t1
join employee t2
on t1.department_id = t2.department_id 
and t1.chief_flg = False
and t2.chief_flg = True
and t1.birth_dt < t2.birth_dt
group by t1.id, t1.department_id
 ```

 # [2] Задача 

 ```sql
with tmp as (
  select transaction_id, customer_id, amount_rur, transaction_dttm,
  row_number() over (partition by customer_id order by transaction_dttm) as rn,
  sum(amount_rur) over (partition by customer_id) as sm
  from transactions
  where success_flg = True
)
select  transaction_id, customer_id, amount_rur, transaction_dttm
from tmp
where rn = 1 and sm > 1000000
 ```

  # [3] Задача 

 ```sql
with tmp as (
  select transaction_id, customer_id, amount_rur,
  lag(amount_rur) over (partition by customer_id order by transaction_dttm) as lg,
  lead(amount_rur) over (partition by customer_id order by transaction_dttm) as ld
)
select transaction_id, customer_id, amount_rur
from tmp
where amount_rur > lg and amount_rur < ld
 ```

# [4] Задача 

 ```sql
with tmp as (select client_id, sum(amount) as sm
from transaction t join account a on t.account_id = a.id
where transaction_date > current_date - interval '1 month'
and type = 'покупка'
group by client_id)
select distinct name
from client c join account a2 on c.id = a2.client_id
where close_dt is null
and c.id in (select client_id from tmp where sm < 5000)
and open_dt < current_date - interval '1 year'
 ```

# [5] Задача 

 ```sql
SELECT 
    c1.id,
    c1.points,
    COUNT(DISTINCT c2.points) + 1 as position
FROM sandbox.zvereva_competition c1
LEFT JOIN sandbox.zvereva_competition c2 ON c2.points > c1.points
GROUP BY c1.id, c1.points
ORDER BY c1.points DESC;
 ```
</details>


<details>
  <summary>Лига цифровой экономики</summary>

пн

# [1] Задача 

t1: 3   t2: 4
INNER JOIN
min: 0
max: 12

LEFT JOIN
min: 3
max: 12

RIGHT JOIN
min: 4
max: 12

FULL JOIN
min: 4
max: 12

CROSS JOIN
min: 12
max: 12


 # [2] Задача 

 ```sql
SELECT value, count(value) as cnt
from T
group by value
having count(value) > 1
 ```

# [3] Задача 

 ```sql
tmp as (SELECT empl_fio, empl_dep, amount,
row_number() over (partition by empl_dep order by amount desc) as rn
from salary
where extract(month from value_day) = 4
and extract(year from value_day) = 2023)
select empl_fio, empl_dep, amount from tmp
where rn = 2
 ```

 # [4] Задача 

 ```sql
with tmp as (select empl_fio, empl_dep, amount as may_amount,
dense_rank() over (order by amount) as rank
from salary
where extract(month from value_day) = 5
and extract(year from value_day) = 2023),

apr as (
  select empl_fio, empl_dep, amount as april_amount, value_day
  from salary
  where extract(month from value_day) = 4
and extract(year from value_day) = 2023) 


select t.empl_fio, t.empl_dep, (may_amount - april_amount) as diff, may_amount
from tmp t join apr a on t.empl_fio = a.empl_fio and t.empl_dep = a.empl_dep 
where rank <= 3
 ```
</details>

<details>
  <summary>Wildberries</summary>

вт

 # [1] Задача 

 ```sql
select t1.id, t1.name, t1.salary, t2.salary
from employee t1 join employee t2 on t1.manager_id = t2.id and t1.salary > t2.salary

 ```

 # [2] Задача 

 ```sql
with tmp as (select id, name, salary, departmentID,
dense_rank() over (partition by departmentID order by salary desc) as rk
from employee)
select name
from tmp
where rk <= 3
 ```
# [3] Задача 

 ```python
'''Напишите функцию, которая принимает на вход список hours (содержащий N элементов) и целое число target.
Функция должна возвращать количество сотрудников, отработавших не меньше target часов'''

def func(hours, target):
  cnt = 0
  for i in range(len(hours)):
    if hours[i] >= target:
      cnt += 1
  return cnt
 ```

 # [3] Задача 

 ```python
df['DepositionSum'].mean()
df['WithdrawalSum'].mean()

df.groupby('Day').agg({'DepositionSum': 'mean',
                       'WithdrawalSum': 'mean'}).mean()

df.groupby('UserId').agg({'DepositionSum': 'mean',
                       'WithdrawalSum': 'mean'}).mean()

df['DepositionSum'].sum() - df['WithdrawalSum'].sum()

'''Сегментация: k-means, по сумме депозита, по частоте'''

 ```

</details>

<details>
  <summary>Бетсити</summary>

ср

 # [1] Задача 

 d

 # [2] Задача 

 bc

b. TRUNCATE TABLE my_table - удаляет все строки, быстрее, нельзя откатить
c. DELETE FROM my_table - удаляет все строки, можно использовать с WHERE, можно откатить
a. DROP TABLE my_table - удаляет саму таблицу
d. DELETE my_table - неверный синтаксис (требуется FROM)

 # [3] Задача 

(4500*20+1500*50+2500*30)/100
2400

 # [4] Задача 

Доходы с контрольной группы: 1500
Доходы с целевой группы: 18000
Расходы на рассылку контроль: 500
Расходы на рассылку целевая: 4500

Прибыль со старой конверсией:
10000*0.03*50 = 15000

Прибыль с новой конверсией:
10000*0.04*50 - 5000 = 15000

Итого: эффекта нет


# [5] Задача 

 ```sql
select t1.name, t1.salary, t2.name, t2.salary, t3.name
from employee t1 join employee t2 on t1.chief_id = t2.id 
join department t3 on t1.department_id = t3.id
where t2.salary / t1.salary between 1.5 and 2
 ```


# [6] Задача 

 ```sql
select extract (month from sale_dttm) as month, extract (year from sale_dttm) as year,
percentile_cont(0.5) within group (order by price * (1-discount/100))
from tmp
group by year, month
order by year, month
 ```



</details>


<details>
  <summary>Wildberries</summary>

чт

 # [1] Задача 

 ```sql
with tmp as (select courier_id, pickup_point,
avg(delivery_time) as ag
from orders
where delivery_time <= 120
group by courier_id, pickup_point),

tmp_2 as (select pickup_point, courier_id, 
row_number() over (partition by pickup_point order by ag) as rn
from tmp)

select pickup_point, courier_id from tmp_2
where rn = 1
 ```

# [2] Задача 

 ```sql
with tmp as (select order_date, courier_id, avg(delivery_time) as ag_days
from deliveries
group by order_date, courier_id)

select order_date, courier_id,
avg (ag_days) over (partition by courier_id order by order_date rows between 6 preceding and current row)
from tmp
 ```

# [3] Задача 

 ```python
 import pandas as pd
 df = pd.read_csv('Таблица')

 df.groupby('courier_id').agg({'delivery_time':'mean', 'distance':'mean'})

df['efficiency'] = df['distance']/df['delivery_time']
df.groupby(['start_location', 'end_location']).agg({'efficiency': 'mean'})

df.groupby('courier_id')['efficiency'].mean().sort_values(ascending=False)
 ```

</details>

<details>
  <summary>HeadHunter</summary>

пт

# [1] Задача 

 ```sql

 ```





</details>


</details>